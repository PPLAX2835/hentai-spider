<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Demo</title>
    <!-- 请勿在项目正式环境中引用该 layui.css 地址 -->
    <link href="//unpkg.com/layui@2.9.6/dist/css/layui.css" rel="stylesheet">
</head>
<body>
<table class="layui-hide" id="ID-table-demo-editmodes"></table>

<!-- 推荐 -->
<script type="text/html" id="TPL-dropdpwn-demo">
    <button class="layui-btn layui-btn-primary dropdpwn-demo">
        <span>{{= d.sex || '保密' }}</span>
        <i class="layui-icon layui-icon-down layui-font-12"></i>
    </button>
</script>

<!-- 请勿在项目正式环境中引用该 layui.js 地址 -->
<script src="//unpkg.com/layui@2.9.6/dist/layui.js"></script>
<script>
    layui.use(function(){
        var $ = layui.$;
        var table = layui.table;
        var form = layui.form;
        var dropdown = layui.dropdown;

        // 渲染
        table.render({
            elem: '#ID-table-demo-editmodes',
            url: '/json/user.json', // 此处为静态模拟数据，实际使用时需换成真实接口
            page: true,
            css: [ // 设置单元格样式
                // 取消默认的溢出隐藏，并设置适当高度
                '.layui-table-cell{height: 50px; line-height: 40px;}',
                '.layui-table-cell .layui-colorpicker{width: 38px; height: 38px;}',
                '.layui-table-cell select{height: 36px; padding: 0 5px;}'
            ].join(''),
            cols: [[ // 表头
                {field: 'id', title: 'ID', width:80, align: 'center', fixed: 'left'},
                {field: 'sex', title: 'dropdown', width:115, unresize: true, align: 'center', templet: '#TPL-dropdpwn-demo'},
            ]],
            done: function(res, curr, count){
                var options = this;

                // 获取当前行数据
                table.getRowData = function(tableId, elem){
                    var index = $(elem).closest('tr').data('index');
                    return table.cache[tableId][index] || {};
                };

                // dropdown 方式的下拉选择
                dropdown.render({
                    elem: '.dropdpwn-demo',
                    // trigger: 'hover',
                    // 此处的 data 值，可根据 done 返回的 res 遍历来赋值
                    data: [{
                        title: '男',
                        id: 100
                    },{
                        title: '女',
                        id: 101
                    },{
                        title: '保密',
                        id: 102
                    }],
                    click: function(obj){
                        var data = table.getRowData(options.id, this.elem); // 获取当前行数据(如 id 等字段，以作为数据修改的索引)

                        this.elem.find('span').html(obj.title);
                        // 更新数据中对应的字段
                        data.sex = obj.title;
                        // 显示 - 仅用于演示
                        layer.msg('选中值: '+ obj.title +'<br>当前行数据：'+ JSON.stringify(data));
                    }
                });

            }
        });
    });
</script>

</body>
</html>